"use strict";var exports={};browsers.define("calendar",["jquery","musicsig"],function(a,b){var c={$sidebar:null,clockCanvas:null,init:function(){c.$sidebar=a("#side_bar")},addCalendar:function(){if(c.$sidebar.length){var d=a("<div>").attr("id","musicsig-calendar"),e=a("<img/>").addClass("close_button").attr("src","/images/hide_left_2x.gif").click(function(){d.remove(),a(document).trigger("MusicSig.disableCalendar")});d.append(e);var f=a("<table>"),g=a("<tr>");b.lang("daysofweek").split(/\|/g).forEach(function(b){a("<td>").text(b).appendTo(g)}),f.append(g),g=a("<tr>");var h,i=new Date,j=i.getDate(),k=i.getMonth(),l=i.getFullYear();i.setDate(1),h=(h=i.getDay())?h-1:6;for(var m=0;h>m;m++)a("<td>").appendTo(g);var n,o=c.daysInMonth(k,l);for(h=1;o>=h;h++)n=[],5===m?n.push("saturday"):6===m&&n.push("sunday"),h===j&&n.push("today"),a("<td>").text(h).addClass(n.join("")).appendTo(g),6===m&&h!==o?(m=0,f.append(g),g=a("<tr>")):m++;for(;6>m;m++)a("<td>").appendTo(g);f.append(g),c.$sidebar.find("ol:first-child").after(d),d.append(f),f.wrap('<a href="?w=calendar"><a>')}},daysInMonth:function(a,b){return 1===a?b%4!==0||b%100===0&&b%400!==0?28:29:[31,0,31,30,31,30,31,31,30,31,30,31][a]},renderClock:function(){var a=c.clockCanvas,b=new Date,d=a.getContext("2d");d.save(),d.clearRect(0,0,150,150),d.translate(57,75),d.scale(.4,.4),d.rotate(-Math.PI/2),d.strokeStyle="black",d.fillStyle="white",d.lineWidth=8,d.lineCap="round",d.save();for(var e=0;12>e;e++)d.beginPath(),d.rotate(Math.PI/6),d.moveTo(100,0),d.lineTo(120,0),d.stroke();for(d.restore(),d.save(),d.lineWidth=5,e=0;60>e;e++)e%5&&(d.beginPath(),d.moveTo(117,0),d.lineTo(120,0),d.stroke()),d.rotate(Math.PI/30);d.restore();var f=b.getMilliseconds(),g=b.getSeconds(),h=b.getMinutes();b=b.getHours(),b=b>=12?b-12:b,d.fillStyle="black",d.save(),d.rotate(b*(Math.PI/6)+Math.PI/360*h+Math.PI/21600*g),d.lineWidth=14,d.beginPath(),d.moveTo(-20,0),d.lineTo(80,0),d.stroke(),d.restore(),d.save(),d.rotate(Math.PI/30*h+Math.PI/1800*g+Math.PI/18e5*f),d.lineWidth=10,d.beginPath(),d.moveTo(-28,0),d.lineTo(112,0),d.stroke(),d.restore(),d.save(),d.rotate(g*Math.PI/30+f*Math.PI/3e4),d.strokeStyle="#D40000",d.fillStyle="#D40000",d.lineWidth=6,d.beginPath(),d.moveTo(-30,0),d.lineTo(83,0),d.stroke(),d.beginPath(),d.arc(0,0,10,0,2*Math.PI,!0),d.fill(),d.restore(),d.beginPath(),d.lineWidth=14,d.strokeStyle="#325FA2",d.arc(0,0,132,0,2*Math.PI,!0),d.stroke(),d.restore()},addClock:function(){if(c.$sidebar){var b;if(!c.clockCanvas){var d=a("<div>").attr("id","musicsig-clock"),e=a("<img/>").addClass("close_button").attr("src","/images/hide_left_2x.gif").click(function(){clearInterval(b),d.remove(),a(document).trigger("MusicSig.disableClock")});d.append(e);var f=document.createElement("canvas");f.setAttribute("width",115),f.setAttribute("height",150),c.clockCanvas=f,d.append(f),c.$sidebar.find("ol:first-child").after(d)}c.renderClock(),setInterval(c.renderClock,1e3)}}};return c.init(),c},exports);